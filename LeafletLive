<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Leaflet Live Navigation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  html, body { height: 100%; margin: 0; padding: 0; }
  #map { width: 100%; height: 100%; }

  /* Marker (telefon) uvek u centru */
  .center-marker {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 32px;
    height: 32px;
    margin-left: -16px;
    margin-top: -16px;
    z-index: 1000;
    pointer-events: none;
  }
</style>

</head>
<body>

<!-- Centrirani marker -->
<img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" class="center-marker"/>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Plugin za rotaciju mape -->
<script src="https://cdn.jsdelivr.net/npm/leaflet-rotatedmarker@0.2.0/leaflet.rotatedMarker.min.js"></script>
<script src="https://unpkg.com/leaflet-map-rotate@0.2.1/dist/leaflet-map-rotate.min.js"></script>

<script>
  // Čitanje parametara iz URL-a
  const params = new URLSearchParams(window.location.search);
  const lat = parseFloat(params.get("lat")) || 44.7866;
  const lng = parseFloat(params.get("lng")) || 20.4489;
  const bearing = parseFloat(params.get("bearing")) || 0;

  // Inicijalizacija mape
  const map = L.map('map', {
    rotate: true,
    rotationAngle: bearing,
    zoomControl: false
  }).setView([lat, lng], 18);

  // OpenStreetMap sloj
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19
  }).addTo(map);

  // Pozicioniranje i rotacija
  map.setBearing(bearing);
  map.panTo([lat, lng]);  // drži marker u centru

</script>
</body>
</html>
